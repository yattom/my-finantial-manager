# Development Plan

このファイルには、個人向け金融資産マネジメントシステムの今後の開発計画とTODOリストを記載しています。

## TODO リスト

### 新機能要件（高優先度）

- [ ] **NISA・特定口座対応**
  - 保有資産の種別としてNISA/旧NISA/特定口座を保持する機能を実装
  - 口座種別ごとの集計・レポート機能

- [ ] **配当金・実現益の記録**
  - 配当金などの実現果実を記録し、該当する資産のパフォーマンスに含める機能を実装
  - 分配金、売却益、その他収益の記録

- [ ] **イベントベースの資産データ管理**
  - 資産データを購入や売却などのイベントとして保持する仕組みを実装
  - 取引履歴の完全な追跡が可能に

- [ ] **スナップショット機能**
  - 任意の時点や期間でのスナップショットを取得できる機能を実装
  - スナップショットをデータベースに保存できる機能を実装
  - 過去の任意時点でのポートフォリオ状況を再現

- [ ] **期間別パフォーマンス分析**
  - 指定した期間での資産ごとのパフォーマンスを表示する機能を実装
  - より詳細な分析とレポート機能

### 既存システム改善（高優先度）

- [ ] **API接続の修正**
  - フロントエンドが現在ハードコードされたダミーデータを使用している
  - 実際のバックエンドAPIへの接続を実装する
  - エラーハンドリングを改善する

- [ ] **テストカバレッジの向上**
  - フロントエンドのテストファイル作成
  - バックエンドのテストケース追加
  - エンドツーエンドテストの実装

- [ ] **データ管理の改善**
  - 価格更新の自動化（スケジューラー機能）
  - データバックアップ・リストア機能
  - データ整合性チェック機能

### 中優先度

- [ ] **ユーザーエクスペリエンスの向上**
  - レスポンシブデザインの改善
  - ローディング状態の表示改善
  - エラーメッセージの多言語対応

- [ ] **機能拡張**
  - 配当金・分配金の記録機能
  - 税務関連レポート生成
  - 資産配分の推奨機能
  - アラート・通知機能

- [ ] **データソースの拡張**
  - 複数の価格データプロバイダー対応
  - 為替レート対応（多通貨サポート）
  - ファンダメンタル分析データの追加

### 低優先度

- [ ] **アーキテクチャ改善**
  - マルチテナント対応
  - ユーザー認証・認可システム
  - PostgreSQL等のより堅牢なデータベースへの移行
  - Redis等のキャッシュシステム導入

- [ ] **運用改善**
  - ログ機能の強化
  - メトリクス・モニタリング
  - CI/CDパイプラインの構築
  - Docker本番環境対応

- [ ] **セキュリティ強化**
  - APIキーの安全な管理
  - データ暗号化
  - セキュリティヘッダーの追加
  - 脆弱性スキャン

## 完了済み

- [x] **プロジェクト基盤構築**
  - Docker環境のセットアップ
  - バックエンドAPI（FastAPI）の基本実装
  - フロントエンド（Next.js）の基本実装
  - データベース設計（SQLite + SQLAlchemy）

- [x] **ドキュメント整備**
  - CLAUDE.md（開発ガイド）の作成
  - ビジネス仕様書の作成
  - 開発環境セットアップ手順の整備

## 現状と次にやること

### 現在の状況（2025/5/24時点）

**✅ 完了済み**
- 開発環境の完全セットアップ（Poetry、npm dependencies）
- Docker環境での動作確認
- バックエンドAPIの正常動作確認（FastAPI + SQLAlchemy + SQLite）
- 包括的なドキュメント作成（CLAUDE.md、ビジネス仕様書、開発計画）

**📊 動作状況**
- **バックエンド**: 完全に動作
  - API エンドポイント: http://localhost:8000
  - データベース接続: 正常
  - 基本CRUD操作: 正常
  - テスト: 7件すべて通過
- **フロントエンド**: UI は動作するが API接続未実装
  - 開発サーバー: http://localhost:3000 で正常起動
  - 現在はダミーデータを表示
  - `/api/assets` を呼び出しているが、実際のバックエンドは `/assets`

**🚨 主要課題**
- フロントエンドとバックエンドの API 接続が分離されている
- フロントエンドが Next.js API Routes (`/api/assets`) を想定しているが未実装
- 実際のデータ連携ができていない

### 次にやること（優先順）

**🔥 緊急（基本機能の完成）**
1. **フロントエンドのAPI接続修正**
   - `/api/assets` → `http://localhost:8000/assets` への変更
   - その他のAPIエンドポイントも同様に修正
   - エラーハンドリングの改善

2. **基本機能の動作確認**
   - 資産追加機能のテスト
   - 価格更新機能のテスト
   - パフォーマンス分析機能のテスト

**⚡ 高優先度（新機能実装）**
3. **NISA・特定口座対応**
4. **配当金・実現益の記録**
5. **イベントベースの資産データ管理**

### 技術的な注意点
- 現在のシステムは基盤が整っているため、API接続修正後は新機能実装に集中できる
- データベーススキーマの大幅変更が必要な機能は、段階的に実装する

## 注意事項

- 各機能実装前には必ずテストを作成し、実装後にテストを実行すること
- APIの変更時にはフロントエンド・バックエンド両方の影響を考慮すること
- データベーススキーマの変更時にはマイグレーション戦略を検討すること
- セキュリティに関わる変更は特に慎重に検討・実装すること